<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Carte interactive des communes</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: sans-serif;
      background-color: #f0f0f0;
    }
    #container {
      display: flex;
      flex-direction: column;
      padding: 20px;
      gap: 20px;
    }
    #main-content {
      display: flex;
      flex-direction: column;
    }
    #map {
      width: 100%;
    }
    #info1, #info2, #photo {
      background: #fff;
      padding: 15px;
      margin-top: 10px;
    }
    #info2 {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    @media (min-width: 768px) {
      #main-content {
        flex-direction: row;
        gap: 20px;
      }
      #map {
        flex: 1;
      }
      #right-panel {
        flex: 1;
        display: flex;
        flex-direction: column;
        gap: 20px;
      }
      #info2 {
        flex-direction: row;
      }
      .column {
        flex: 1;
      }
    }
    svg path {
      cursor: pointer;
      transition: fill 0.3s;
    }
    svg path:hover {
      fill: #a3c94f !important;
    }
    .tooltip {
      position: absolute;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      pointer-events: none;
      font-size: 14px;
      display: none;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="container">
    <div class="tooltip" id="tooltip"></div>
    <div id="main-content">
      <div id="map">
        {svg_clean}
      </div>
      <div id="right-panel">
        <div id="info1">
          <h2>Nos communes</h2>
          <p>Survolez une commune puis cliquez dessus pour afficher ses informations.</p>
        </div>
        <div id="photo">
          <img id="photo-img" src="https://via.placeholder.com/400x200?text=Photo+Commune" alt="Photo commune" style="width:100%; height:auto;">
        </div>
      </div>
    </div>
    <div id="info2">
      <div class="column" id="info2-left"></div>
      <div class="column" id="info2-right"></div>
    </div>
  </div>
  <script>
    const data = {
      "Sées": {
        nom: "Sées",
        population: "3 900",
        mairie: "1 Place du Général de Gaulle, 61500 Sées",
        horaires: "Lundi au vendredi : 8h30 - 12h / 13h30 - 17h",
        photo: "https://via.placeholder.com/400x200?text=S%C3%A9es",
        conseil: "20 élus dont le Maire et ses adjoints.",
        services: "École, Médiathèque, Centre culturel, Crèche.",
        associations: "Sportives, culturelles, caritatives...",
        lien: "https://www.ville-sees.fr/"
      },
      "Le_Chateau_d_Almenêches": {
        nom: "Le Château d'Almenêches",
        population: "312",
        mairie: "Le Bourg, 61570 Le Château-d'Almenêches",
        horaires: "Mardi et jeudi : 9h - 12h",
        photo: "https://via.placeholder.com/400x200?text=Ch%C3%A2teau+d'Almen%C3%AAches",
        conseil: "11 élus",
        services: "Salle polyvalente, Aire de jeux",
        associations: "Comité des fêtes",
        lien: "https://www.cdc-sourcesdelorne.fr/les-communes/le-ch%C3%A2teau-d-almen%C3%AAches/"
      }
    };

    const tooltip = document.getElementById("tooltip");
    const container = document.getElementById("container");

    container.addEventListener("mouseover", (e) => {
      const path = e.target.closest("path");
      if (path && data[path.id]) {
        tooltip.textContent = data[path.id].nom;
        tooltip.style.display = "block";
      }
    });

    container.addEventListener("mousemove", (e) => {
      tooltip.style.left = (e.pageX + 10) + "px";
      tooltip.style.top = (e.pageY + 10) + "px";
    });

    container.addEventListener("mouseout", (e) => {
      const path = e.relatedTarget?.closest("path");
      if (!path) {
        tooltip.style.display = "none";
      }
    });

    container.addEventListener("click", (e) => {
      const path = e.target.closest("path");
      if (path && data[path.id]) {
        const commune = data[path.id];
        document.getElementById("info1").innerHTML = `
          <h2>${commune.nom}</h2>
          <p><strong>Population :</strong> ${commune.population}</p>
          <p><strong>Adresse de la mairie :</strong> ${commune.mairie}</p>
          <p><strong>Horaires d'ouverture :</strong> ${commune.horaires}</p>
        `;
        document.getElementById("photo-img").src = commune.photo;
        document.getElementById("info2-left").innerHTML = `
          <p><strong>Conseil municipal :</strong><br>${commune.conseil}</p>
          <p><strong>Services / équipements :</strong><br>${commune.services}</p>
        `;
        document.getElementById("info2-right").innerHTML = `
          <p><strong>Associations :</strong><br>${commune.associations}</p>
          <p><a href="${commune.lien}" target="_blank">Lien vers la commune</a></p>
        `;
      }
    });
  </script>
</body>
</html>
